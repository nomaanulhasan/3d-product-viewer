import*as THREE from"./three.module.js";import{OrbitControls}from"./OrbitControls.js";import{OBJLoader2}from"./OBJLoader2.js";import{MTLLoader}from"./MTLLoader.js";import{MtlObjBridge}from"./MtlObjBridge.js";function main(){const e=document.querySelector("#prdViewer"),t=new THREE.Clock,a=new THREE.Scene,i=window.innerWidth/window.innerHeight,n=new THREE.PerspectiveCamera(45,i,.1,100),o=new THREE.WebGLRenderer({canvas:e,logarithmicDepthBuffer:!0}),r=document.getElementById("info"),s=document.getElementById("btnReset"),d=document.getElementById("zoomSlider"),c=document.getElementById("zoomIn"),l=document.getElementById("zoomOut");a.background=new THREE.Color("white"),n.position.set(0,10,0),CameraControls.install({THREE:THREE});const m=new CameraControls(n,e);m.addEventListener("change",()=>console.log(m.getPosition())),m.setLookAt(1.83,.92,1.02,0,.5,0),e.addEventListener("mousedown",e=>e.target.style.cursor="grabbing"),e.addEventListener("mouseup",e=>e.target.style.cursor="grab"),e.addEventListener("wheel",()=>d.value=m.distance),d.addEventListener("input",e=>{m.dollyTo(e.target.value,!0)}),r.addEventListener("click",e=>{e.target.parentNode.classList.toggle("visible")}),s.addEventListener("click",()=>{document.querySelector("li.active").classList.remove("active"),document.querySelector(".front-view").classList.add("active"),m.reset(!0)}),l.addEventListener("click",()=>{m.dolly(-.2,!0),setTimeout(()=>{d.value=m.distance},100)}),c.addEventListener("click",()=>{m.dolly(.2,!0),setTimeout(()=>{d.value=m.distance},100)});{const e=11657727,t=12155424,i=1,n=new THREE.HemisphereLight(e,t,i);a.add(n)}{const e=16777215,t=.2,i=new THREE.DirectionalLight(e,t);i.position.set(0,10,0),a.add(i),a.add(i.target)}{const e=16777215,t=.2,i=new THREE.DirectionalLight(e,t);i.position.set(0,-10,0),a.add(i),a.add(i.target)}{const e=16777215,t=.3,i=new THREE.DirectionalLight(e,t);i.position.set(-20,0,0),a.add(i),a.add(i.target)}{const e=16777215,t=.3,i=new THREE.DirectionalLight(e,t);i.position.set(20,0,0),a.add(i),a.add(i.target)}{const e=16777215,t=.3,i=new THREE.DirectionalLight(e,t);i.position.set(0,0,-20),a.add(i),a.add(i.target)}{const e=16777215,t=.3,i=new THREE.DirectionalLight(e,t);i.position.set(0,0,20),a.add(i),a.add(i.target)}(new MTLLoader).load("models/chair/black_leather_chair.mtl",e=>{const t=new OBJLoader2,i=MtlObjBridge.addMaterialsFromMtlLoader(e);for(const e of Object.values(i))e.side=THREE.DoubleSide;t.addMaterials(i),t.load("models/chair/black_leather_chair.obj",e=>{a.add(e);const t=(new THREE.Box3).setFromObject(e),i=t.getSize(new THREE.Vector3).length();t.getCenter(new THREE.Vector3);[...document.querySelectorAll("nav ul li")].forEach(e=>{e.addEventListener("click",e=>{document.querySelector("li.active").classList.remove("active"),e.stopPropagation(),setTimeout(()=>{switch(e.target.className){case"side1-view":m.reset(!0),m.rotate(-45*THREE.Math.DEG2RAD,0,!0),e.target.classList.add("active");break;case"side2-view":m.reset(!0),m.rotate(45*THREE.Math.DEG2RAD,0,!0),e.target.classList.add("active");break;case"back-view":m.reset(!0),m.rotate(180*THREE.Math.DEG2RAD,0,!0),e.target.classList.add("active");break;default:m.reset(!0),e.target.classList.add("active")}},1)})}),m.minDistance=.5*i,m.maxDistance=2*i,d.min=m.minDistance,d.max=m.maxDistance,d.value=1.2*i,m.saveState(),setTimeout(()=>{document.getElementById("preloader").style.display="none"},500)})});!function e(){const i=t.getDelta(),r=(t.getElapsedTime(),m.update(i));requestAnimationFrame(e),r&&o.render(a,n)}(),requestAnimationFrame(function e(){if(requestAnimationFrame(e),n.updateProjectionMatrix(),TWEEN.update(),function(e){const t=e.domElement,a=t.clientWidth,i=t.clientHeight,n=t.width!==a||t.height!==i;return n&&e.setSize(a,i,!1),n}(o)){const e=o.domElement;n.aspect=e.clientWidth/e.clientHeight,n.updateProjectionMatrix()}o.render(a,n)})}main();